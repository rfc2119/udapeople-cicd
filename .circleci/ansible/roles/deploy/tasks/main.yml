---

- name: Copy backend built files to backend server
  synchronize:
    src: project/backend/dist
    dest: udapeople-cicd/backend/
    recursive: yes
    archive: yes

- name: start production server (NOT using start:prod script)
  shell:
    # cmd: pm2 start --name "api-backend" npm -- run start:prod
    cmd: pm2 start --name "api-backend" dist/main.js
    chdir: udapeople-cicd/backend
    # TODO: systemd and start as a service
